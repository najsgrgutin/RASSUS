{"version":3,"file":"static/webpack/static/development/pages/login.js.97d51be4ff7a7427b40c.hot-update.js","sources":["webpack:///./pages/login.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport Router from \"next/router\";\nimport { useForm } from \"react-hook-form\";\nimport queryString from \"querystring\";\nimport axios from \"axios\";\nimport styles from \"../styles/Login.module.css\";\nimport ErrorMessage from \"../components/ErrorMessage\";\nimport jwt from \"jsonwebtoken\";\nconst publicKey = \"-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAhdrwpRXz5RKiqClu9IzbGjuLYKnZmsloTd/IAEVpUFbKIRgw6GiTWClxv4d7EMCNx3Kcze9urtrbmd2U0uYLMd1fV6LPqN+uHpZwxa1OviEC95Al2yBt3kLNhbhUr7dx5GrUgaWn7ohFqiH1TvD3XuieP0pyhKMfJExyxAMoZDa4zao4RpWTziLLyHatqM/88IVMvgwmzhp5xlHmSyR7dnHbxfPheO7wwb28wFJAbsKlm94Dl+SB9OduCT12645Gs5byhnMwdboR03lyzzyXeaXCvd3F/a6fmwpjbQxXJek5USh+wVnLLxoNxm48ZCwbXO/9xrkzjXaSqkFcOl6dEwIDAQAB-----END PUBLIC KEY-----\";\nconst clientSecret = \"489eedf0-1ad8-4ebd-bf60-426709339e66\";\n\nconst Login = () => {\n  const { register, handleSubmit, errors } = useForm();\n\n  const [showError, setShowError] = useState(false);\n\n  function handleLoginClick(data) {\n    setShowError(false);\n    const params = {\n      client_secret: clientSecret,\n      username: data.username,\n      password: data.password,\n      grant_type: \"password\",\n      client_id: \"frontend\"\n    };\n\n    axios({\n      method: \"post\",\n      url:\n        \"http://localhost:8080/auth/realms/govanj/protocol/openid-connect/token\",\n      data: queryString.stringify(params),\n      config: {\n        headers: {\n          \"Content-Type\": \"application/x-www-form-urlencoded\"\n        }\n      }\n    })\n      .then(res => {\n        if (res.request.status === 200) {\n          jwt.verify(res.data.access_token, publicKey, (err, decoded) => {\n            if (err) {\n              console.log(\"Token couldn't be verified\");\n            } else {\n              console.log(decoded);\n              localStorage.setItem(\"token\", res.data.access_token);\n              Router.push(\"/mail\");\n            }\n          });\n        } else {\n          console.log(\"Something went wrong\");\n        }\n      })\n      .catch(error => {\n        setShowError(true);\n        console.error(error);\n      });\n  }\n\n  return (\n    <form\n      className={styles.loginContainer}\n      onSubmit={handleSubmit(handleLoginClick)}\n    >\n      <h1 className={styles.loginTitle}>Login</h1>\n      <input\n        className={styles.loginInput}\n        placeholder=\"Username\"\n        name=\"username\"\n        ref={register({\n          required: true\n        })}\n      />\n      <div className={styles.mailErrorMessage}>\n        {errors[\"username\"] && errors[\"username\"].message}\n      </div>\n      <input\n        className={styles.loginInput}\n        placeholder=\"Password\"\n        name=\"password\"\n        type=\"password\"\n        ref={register({\n          required: true\n        })}\n      />\n      <button className={styles.loginButton} type=\"submit\">\n        Login\n      </button>\n      {showError ? (\n        <ErrorMessage message={\"Wrong username or password\"} />\n      ) : null}\n    </form>\n  );\n};\n\nexport default Login;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AACA;AAEA;AACA;AACA;AACA;AADA;AADA;AALA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AADA;AAJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AACA;AACA;AACA;AADA;AALA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;;;;A","sourceRoot":""}